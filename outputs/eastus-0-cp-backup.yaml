image:
  registry: r161swx010tsbacrwqwv7ongq6kl7zqo.azurecr.io
  tag: 1.6.1
operator:
  deployment:
    env:
    - name: ISTIO_ISOLATION_BOUNDARIES
      value: "false"
secrets:
  clusterServiceAccount:
    JWK: '{"alg":"RS256","d":"ow1YCL79DOn-of4G_R2QQSNX3OTH_zpBE9M7Ex8l_QU8wQgteWuqy6qOvOCN56_LVw0gDf71f-hZV2EMRbKxPx-2eJ0ambrbafK2bD85ptNOfK3IntErG7LNTYBwrGhXqcfYcAZndH55DwMIfmJeRONXi_LqxmWzO0yHrFPk6HY0ANW-jmBFN91EVyNPFHXlQDaeG2KqNL-egmnXwkfg6IbHDbMxr5e9qljmuR_e_K8Vv9cIIm-OsjvlRnJe2qfYO-oKGEMZCJLipaFLzkcS6WBn4_fTo7vfwmZe-EtBEXt0yt3rxtiRKcv5Zg5aj36it6mGp43E0oHi8FaRTqmYAQ","dp":"DWRz4Aft0PBad_eZdumGbugxzitJUUp3ectnelBX_8tuDeEw0HfEm-Zy7LyruFMW2jugyewaazOoQeYTPvZbjjH3qd071UZiXFw9R8e9JPuUJL_Gbtwpez2PzKSTFkFzJ_dyCsHx2nvlFop1o22tY7Sk2FFTXcEatBttax3bdfE","dq":"f4L6FDN_fvXcjW69j_HxtOksGT_9wt01i3f7P3CoPM-0eSkVNDsDOIHX-_oblLiNsatgFzL5nSwuxqzYYNXZe3rIhhTTiBsTk9hVHWsHHeEPak2jqj45oIoC712bZqRWYFTTnBIc2bjtQKimAnY_9Sk9m2JupNAQDeNp8iDtVsk","e":"AQAB","kid":"OU7XB1WyjR9WYLVfkyHksEarg_iNa2nWIivhBrf2KGg","kty":"RSA","n":"0-Ni36EqnmlRR3SDOVz7SGI9E8zbeN09ePS0f87owItWxd9shAauabEwmzRb-x1_Yo-Me5v08tTriBfljp0xTwe-f8ZFJsTRZ7TLM-1ZiIMxyWcC_OHWUbHp6QD3IZbDBA70lpKjD3YpAKFBoa3z2qXUYdcE1tMimqNtHwC8u5i0hTysIf3qresAv9HNjsxX6aX6BaSKA7FZTmLF2LFZet3pR12LD0rT8TnjHyQNmVIsTcNL0E_nteGMttp-zzuoAgIGdFgZF5R8S4hMpDT7Oi3gVqa7C2LafB-wFczD3bP0152vEcI6RMGOTlOdSGufUkBAqsJ49ZMMURDNNt3wDw","p":"6S6bX7-mSD23HLS9PwwPzu__WDgB8ZEOKhd7oMUfS5di1_UHdUsoyPtLkybvM1YvJ525GaIqZIcsLZdWlTFpl-h1PhayF4wU3M9qGeoG2bCjQL4bqAgvS9ZPlr3fi97n4kBXNMbpLUeFMte_pv4mua1VfUqFPg9EGFuDTTaV4u0","q":"6J9aJ315pZCD1C7woGulLRYZKIjCFG4zp7toouc6KO6mW_BA-K0E5j1J1wZ3p2_l2T3INM_5uuOb6YHU8QW-9kDZGOwzZoVtiRtJJ8PUn1eTTq4mFNJkRTwysOdOY7URkEjiygZHD5OBDT1cZ9gcW59VAVcJ_-8Lwf-oIZlSk2s","qi":"RtDciqd6ue_F-g-nChunFmuB1-ZBZYXUlcTue2q8h2HZ6qWZYo6J5jKGpHxmXsJlLPERxg9Z4i6Au3R8a2_A_ufHqLmCmDX0diaKiv1YMdmk7LlsDyg7ZB_6ykeHsqSnLpxXn-BhNwUMaYr7RUHZwE1AO5mOU5kOIOHEPPDrScQ"}'
    clusterFQN: organizations/tetrate/clusters/aks-r161swx01-eastus-0
  elasticsearch:
    cacert: |
      -----BEGIN CERTIFICATE-----
      MIIDLTCCAhWgAwIBAgIQTRX7lT4m8xqDQCylj9R8AzANBgkqhkiG9w0BAQsFADAh
      MQwwCgYDVQQLEwN0c2IxETAPBgNVBAMTCHRzYi1odHRwMB4XDTIzMDUxNzAyMTEx
      NVoXDTI0MDUxNjAyMjExNVowITEMMAoGA1UECxMDdHNiMREwDwYDVQQDEwh0c2It
      aHR0cDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMie+CazzV1ouwqH
      yevlb2hBLkVtJkW2j2l2Z17Wh1JSeVKYelIQ79IO5Lyee4m6jvi8tB6yXpATkc6w
      Qq0fO/fG+5M8zz64X5UzGEn4DrdY22xjIML9WrX/nj3G6cHcIVRni2LkU5e4Zzzr
      9qY1paMDVnE1o87GPfuH5xKChetwjJ2tkL3+X6bBIavrjcE5n+fDnJ0Kw6KB8BVq
      /iRW0Mx8fbOFmo6MKG0Z0NtH+W4J65ikpdP/8yw4HiEWO8Va11oFcVSgSGGp78bz
      gKMAxKFEGmXDeNYZp5g16VeLsJORm7QpOFAxyIRLNNU/+poLt0O4kzcqoZF534Ov
      k6FB3q8CAwEAAaNhMF8wDgYDVR0PAQH/BAQDAgKEMB0GA1UdJQQWMBQGCCsGAQUF
      BwMBBggrBgEFBQcDAjAPBgNVHRMBAf8EBTADAQH/MB0GA1UdDgQWBBSNiC/JIY0M
      OPpLRvIGU8+RTykm5DANBgkqhkiG9w0BAQsFAAOCAQEAXY/uTKEn9QmOvwSKfyuB
      k7QGwvpN0nXKSn0dvNyVhkiTslUCie+rg3dL0Un2baTdZExUMzTEPhOgmokNnDCj
      YDTFUQV/MkN+/CQiHOSrv91gaE41u8ePe49s9AEggBgV+fkOVN+bvTXYT+n0UyA9
      +mAtc5pPhz+4TUOVxLTWc05fdhtDESjaoHvm+QnjQXgLI/3dnd5/Z4l0aVcEOnVc
      bhtIIXoDDFPjI3tOGhWxFfdubo5e//WCHwsqZzIelaSsq2yGN7XHBDwBEYP9BhaK
      c+AnpvjFNP7+JgfHYFb9I7EEPiDSIvxyNJtjPVnzZvOkatgVQTjjZy/OlIvym/JX
      TQ==
      -----END CERTIFICATE-----
    password: 05iBg3wiyRF9zV00Bc71y20q
    username: elastic
  tsb:
    cacert: |
      -----BEGIN CERTIFICATE-----
      MIIDKjCCAhKgAwIBAgIQeUSPYwgq/eof/rLollPadTANBgkqhkiG9w0BAQsFADAv
      MRUwEwYDVQQKEwxjZXJ0LW1hbmFnZXIxFjAUBgNVBAMTDXNlbGZzaWduZWQtY2Ew
      HhcNMjMwNTE3MDIyMTI5WhcNMjUxMTAyMDIyMTI5WjAvMRUwEwYDVQQKEwxjZXJ0
      LW1hbmFnZXIxFjAUBgNVBAMTDXNlbGZzaWduZWQtY2EwggEiMA0GCSqGSIb3DQEB
      AQUAA4IBDwAwggEKAoIBAQDHlg4PXIXlunyN24oguIU196Kcikl4OwT2j0FBrfz9
      zNrQlEz4Q13drM9u6GT6saQ7LevFRscxDgPWkFxaJ2syCobmanoxjQe7ccYfkgj9
      Dx5fqovV/4DTc47kqdAB253Kp3pzuqX7KP3B+9CNIDFMFA3DSJJ6aTyXhzeDQp1L
      6dqvFwBpdkv7kg44QAiv1oB2VHXZRCz9KYvdgeqNm7v569lvZJKvk9y0YRtU/pum
      BantaWaBtxja10yCZrHBUIw7B7hbnANAGyWn1u5KIia4xeHJ+hFiHfA+F3VMLpq1
      jkJk9SOscJXSsFZ172WWQzlZeHttTUJSzXV0Tv2IsrGNAgMBAAGjQjBAMA4GA1Ud
      DwEB/wQEAwICpDAPBgNVHRMBAf8EBTADAQH/MB0GA1UdDgQWBBQhf4jnLU5Ttkm3
      SYniFld2YEjTnjANBgkqhkiG9w0BAQsFAAOCAQEALZ0A7VliXMDl0ml5TcVF65Vj
      1kae2KPVoDdtH4YqTn1+UxOiZLKwa6qmgcsjPkkObR9SWMLyrzOuF3SgLGWzgcsL
      zQSqlvHZ5IHJDBMp/8dVtGn/jKJR9Xh+bA6DaFW7BUkP2H1t6K4bd1S1sU/mr+ot
      awBqYSJ2wPdpak+ooEzBNnrMQeftFesnER48fOhJwD/Q5U8uJlNcFFVcfE6XshnU
      ATWd+Bi3Q1ko7U+FzO3FzJxa4xa3PXvAeVg5LARoSjKBYW+JtI+Os9cGRPlaAQ+J
      E6ELrNYOlADjqQyzDvglTwa/jDsoPJ33Oo0QZbXH/d64QaI0afVzivfSidMYiA==
      -----END CERTIFICATE-----
  xcp:
    rootca: |
      -----BEGIN CERTIFICATE-----
      MIIDKjCCAhKgAwIBAgIQeUSPYwgq/eof/rLollPadTANBgkqhkiG9w0BAQsFADAv
      MRUwEwYDVQQKEwxjZXJ0LW1hbmFnZXIxFjAUBgNVBAMTDXNlbGZzaWduZWQtY2Ew
      HhcNMjMwNTE3MDIyMTI5WhcNMjUxMTAyMDIyMTI5WjAvMRUwEwYDVQQKEwxjZXJ0
      LW1hbmFnZXIxFjAUBgNVBAMTDXNlbGZzaWduZWQtY2EwggEiMA0GCSqGSIb3DQEB
      AQUAA4IBDwAwggEKAoIBAQDHlg4PXIXlunyN24oguIU196Kcikl4OwT2j0FBrfz9
      zNrQlEz4Q13drM9u6GT6saQ7LevFRscxDgPWkFxaJ2syCobmanoxjQe7ccYfkgj9
      Dx5fqovV/4DTc47kqdAB253Kp3pzuqX7KP3B+9CNIDFMFA3DSJJ6aTyXhzeDQp1L
      6dqvFwBpdkv7kg44QAiv1oB2VHXZRCz9KYvdgeqNm7v569lvZJKvk9y0YRtU/pum
      BantaWaBtxja10yCZrHBUIw7B7hbnANAGyWn1u5KIia4xeHJ+hFiHfA+F3VMLpq1
      jkJk9SOscJXSsFZ172WWQzlZeHttTUJSzXV0Tv2IsrGNAgMBAAGjQjBAMA4GA1Ud
      DwEB/wQEAwICpDAPBgNVHRMBAf8EBTADAQH/MB0GA1UdDgQWBBQhf4jnLU5Ttkm3
      SYniFld2YEjTnjANBgkqhkiG9w0BAQsFAAOCAQEALZ0A7VliXMDl0ml5TcVF65Vj
      1kae2KPVoDdtH4YqTn1+UxOiZLKwa6qmgcsjPkkObR9SWMLyrzOuF3SgLGWzgcsL
      zQSqlvHZ5IHJDBMp/8dVtGn/jKJR9Xh+bA6DaFW7BUkP2H1t6K4bd1S1sU/mr+ot
      awBqYSJ2wPdpak+ooEzBNnrMQeftFesnER48fOhJwD/Q5U8uJlNcFFVcfE6XshnU
      ATWd+Bi3Q1ko7U+FzO3FzJxa4xa3PXvAeVg5LARoSjKBYW+JtI+Os9cGRPlaAQ+J
      E6ELrNYOlADjqQyzDvglTwa/jDsoPJ33Oo0QZbXH/d64QaI0afVzivfSidMYiA==
      -----END CERTIFICATE-----
spec:
  components:
    gitops:
      enabled: true
      reconcileInterval: 600s
    internalCertProvider:
      certManager:
        managed: EXTERNAL
    istio:
      kubeSpec:
        deployment:
          env:
          - name: ROOT_CA_DIR
            value: /vault/secrets
        overlays:
        - apiVersion: install.istio.io/v1alpha1
          kind: IstioOperator
          name: tsb-istiocontrolplane
          patches:
          - path: spec.meshConfig.defaultConfig.holdApplicationUntilProxyStarts
            value: true
          - path: spec.components.pilot.k8s.podAnnotations
            value:
              vault.hashicorp.com/agent-init-first: "true"
              vault.hashicorp.com/agent-inject: "true"
              vault.hashicorp.com/agent-inject-secret-ca-cert.pem: cluster1-istioca/cert/ca
              vault.hashicorp.com/agent-inject-secret-ca-key.pem: kv/cluster1-istioca
              vault.hashicorp.com/agent-inject-secret-cert-chain.pem: cluster1-istioca/cert/ca_chain
              vault.hashicorp.com/agent-inject-secret-root-cert.pem: pki/cert/ca
              vault.hashicorp.com/agent-inject-template-ca-cert.pem: |
                {{- with secret "cluster1-istioca/cert/ca" -}}
                {{ .Data.certificate  }}
                {{- end }}
              vault.hashicorp.com/agent-inject-template-ca-key.pem: |
                {{- with secret "kv/cluster1-istioca" -}}
                {{ index .Data "istioca-key.pem" }}
                {{- end }}
              vault.hashicorp.com/agent-inject-template-cert-chain.pem: |
                {{- with secret "cluster1-istioca/cert/ca_chain" -}}
                {{ .Data.certificate  }}
                {{- end }}
              vault.hashicorp.com/agent-inject-template-root-cert.pem: |
                {{- with secret "pki/cert/ca" -}}
                {{ "" | or ( .Data.certificate ) }}
                {{- end }}
              vault.hashicorp.com/auth-path: auth/kubernetes
              vault.hashicorp.com/role: cluster1-istiod
    oap:
      streamingLogEnabled: true
    rateLimitServer:
      backend:
        redis:
          uri: redis-master.tsb-ratelimit.svc.cluster.local:6379
      domain: local
    xcp:
      centralAuthMode: JWT
      configProtection: {}
      enableHttpMeshInternalIdentityPropagation: false
      kubeSpec:
        deployment:
          env:
          - name: ENABLE_GATEWAY_DELETE_HOLD
            value: "true"
          - name: GATEWAY_DELETE_HOLD_SECONDS
            value: "20"
        overlays:
        - apiVersion: install.xcp.tetrate.io/v1alpha1
          kind: EdgeXcp
          name: edge-xcp
          patches:
          - path: spec.components.edgeServer.kubeSpec.deployment.env[-1]
            value:
              name: ENABLE_ENHANCED_EAST_WEST_ROUTING
              value: "true"
          - path: spec.components.edgeServer.kubeSpec.deployment.env[-1]
            value:
              name: DISABLE_TIER1_TIER2_SEPARATION
              value: "true"
          - path: spec.components.edgeServer.kubeSpec.deployment.env[-1]
            value:
              name: ENABLE_DNS_RESOLUTION_AT_EDGE
              value: "true"
  hub: r161swx010tsbacrwqwv7ongq6kl7zqo.azurecr.io
  managementPlane:
    clusterName: aks-r161swx01-eastus-0
    host: r161swx01.azure.sandbox.tetrate.io
    port: 443
    selfSigned: true
  meshObservability:
    settings:
      apiEndpointMetricsEnabled: true
  telemetryStore:
    elastic:
      host: 20.120.121.219
      port: 9200
      protocol: https
      selfSigned: true
      version: 7
